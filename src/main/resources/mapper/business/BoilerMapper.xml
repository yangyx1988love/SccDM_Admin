<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="nankai.xl.business.mapper.BoilerMapper" >
  <resultMap id="BaseResultMap" type="nankai.xl.business.model.Boiler" >
    <id column="ID" property="id" jdbcType="INTEGER" />
    <result column="TBOILER_ID" property="tboilerId" jdbcType="INTEGER" />
    <result column="NO" property="no" jdbcType="INTEGER" />
    <result column="version" property="version" jdbcType="VARCHAR" />
    <result column="FUNCTION_DEC" property="functionDec" jdbcType="VARCHAR" />
    <result column="FUNCTIO" property="functio" jdbcType="CHAR" />
    <result column="FUELTYPE_DEC" property="fueltypeDec" jdbcType="VARCHAR" />
    <result column="MODEL_DEC" property="modelDec" jdbcType="VARCHAR" />
    <result column="MODEL" property="model" jdbcType="CHAR" />
    <result column="TONS" property="tons" jdbcType="DOUBLE" />
    <result column="FUELTYPE" property="fueltype" jdbcType="CHAR" />
    <result column="COALASH" property="coalash" jdbcType="DOUBLE" />
    <result column="COALSULFUR" property="coalsulfur" jdbcType="DOUBLE" />
    <result column="COMBUSTIONSYSTEM" property="combustionsystem" jdbcType="CHAR" />
    <result column="FUEL_AUSAGE" property="fuelAusage" jdbcType="DOUBLE" />
    <result column="FUEL_AUSAGEUNIT" property="fuelAusageunit" jdbcType="CHAR" />
    <result column="EXHUST_ID" property="exhustId" jdbcType="INTEGER" />
    <result column="EXF_NO" property="exfNo" jdbcType="INTEGER" />
    <result column="NK_NO" property="nkNo" jdbcType="INTEGER" />
    <result column="dustremove_id" property="dustremoveId" jdbcType="INTEGER" />
    <result column="dustremove_dec" property="dustremoveDec" jdbcType="VARCHAR" />
    <result column="nitreremove_dec" property="nitreremoveDec" jdbcType="VARCHAR" />
    <result column="sulphurremove_dec" property="sulphurremoveDec" jdbcType="VARCHAR" />
    <result column="sulphurremove_id" property="sulphurremoveId" jdbcType="INTEGER" />
    <result column="nitreremove_id" property="nitreremoveId" jdbcType="INTEGER" />
    <result column="factor_status" property="factorStatus" jdbcType="TINYINT" />
    <result column="factor_pm10" property="factorPm10" jdbcType="DOUBLE" />
    <result column="pm10" property="pm10" jdbcType="DOUBLE" />
    <result column="factor_pm25" property="factorPm25" jdbcType="DOUBLE" />
    <result column="pm25" property="pm25" jdbcType="DOUBLE" />
    <result column="factor_co" property="factorCo" jdbcType="DOUBLE" />
    <result column="co" property="co" jdbcType="DOUBLE" />
    <result column="factor_voc" property="factorVoc" jdbcType="DOUBLE" />
    <result column="voc" property="voc" jdbcType="DOUBLE" />
    <result column="factor_pm" property="factorPm" jdbcType="DOUBLE" />
    <result column="pm" property="pm" jdbcType="DOUBLE" />
    <result column="factor_so2" property="factorSo2" jdbcType="DOUBLE" />
    <result column="so2" property="so2" jdbcType="DOUBLE" />
    <result column="factor_nox" property="factorNox" jdbcType="DOUBLE" />
    <result column="nox" property="nox" jdbcType="DOUBLE" />
    <result column="factor_nh3" property="factorNh3" jdbcType="DOUBLE" />
    <result column="nh3" property="nh3" jdbcType="DOUBLE" />
    <result column="factor_oc" property="factorOc" jdbcType="DOUBLE" />
    <result column="oc" property="oc" jdbcType="DOUBLE" />
    <result column="factor_bc" property="factorBc" jdbcType="DOUBLE" />
    <result column="bc" property="bc" jdbcType="DOUBLE" />
    <result column="scc" property="scc" jdbcType="CHAR" />
    <result column="machine_no" property="machineNo" jdbcType="VARCHAR" />
    <result column="coal_volatilisation" property="coalVolatilisation" jdbcType="DOUBLE" />
    <result column="installed_capacity" property="installedCapacity" jdbcType="DOUBLE" />
    <result column="feiqiti" property="feiqiti" jdbcType="DOUBLE" />
    <result column="so2out" property="so2out" jdbcType="DOUBLE" />
    <result column="pmout" property="pmout" jdbcType="DOUBLE" />
    <result column="noxout" property="noxout" jdbcType="DOUBLE" />
    <result column="Jan_useamount" property="janUseamount" jdbcType="DOUBLE" />
    <result column="Feb_useamount" property="febUseamount" jdbcType="DOUBLE" />
    <result column="Mar_useamount" property="marUseamount" jdbcType="DOUBLE" />
    <result column="Apr_useamount" property="aprUseamount" jdbcType="DOUBLE" />
    <result column="May_useamount" property="mayUseamount" jdbcType="DOUBLE" />
    <result column="June_useamount" property="juneUseamount" jdbcType="DOUBLE" />
    <result column="July_useamount" property="julyUseamount" jdbcType="DOUBLE" />
    <result column="aug_useamount" property="augUseamount" jdbcType="DOUBLE" />
    <result column="sept_useamount" property="septUseamount" jdbcType="DOUBLE" />
    <result column="oct_use_amount" property="octUseAmount" jdbcType="DOUBLE" />
    <result column="nov_useamount" property="novUseamount" jdbcType="DOUBLE" />
    <result column="dec_useamount" property="decUseamount" jdbcType="DOUBLE" />
  </resultMap>
  <select id="selectById" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    select * from boiler
    where ID = #{id,jdbcType=INTEGER}
  </select>
  <select id="selectByExhustId" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    select * from boiler
    where EXHUST_ID = #{exhustId,jdbcType=INTEGER}
  </select>
  <select id="selectByFactoryId" resultType="nankai.xl.business.model.vo.BoilerVo" parameterType="java.lang.Integer" >
     SELECT id,NK_NO FROM boiler WHERE EXHUST_ID IN(
          SELECT EXF_ID FROM exhaust WHERE FACTORY_ID = #{factoryId,jdbcType=INTEGER}
          )
     ORDER BY NK_NO ASC
  </select>
  <select id="countByCity" resultType="nankai.xl.business.model.vo.SumVo">
    SELECT COUNT(ss.ID) AS value,city.city_name AS name FROM county
    INNER JOIN (
        SELECT boiler.ID,factory.county_id FROM boiler
        INNER JOIN exhaust
        ON exhaust.EXF_ID=boiler.EXHUST_ID
        INNER JOIN factory
        ON exhaust.FACTORY_ID=factory.factory_id
    ) ss
    ON county.COUNTY_ID=ss.county_id
    INNER JOIN city
    ON county.city_code=city.city_code
    GROUP BY county.city_code
  </select>
  <select id="countByCounty" resultType="nankai.xl.business.model.vo.SumVo">
    SELECT COUNT(ss.ID) AS value,CONCAT(city.city_name,'-',county.COUNTY_NAME) AS name FROM county
    LEFT JOIN (
    SELECT boiler.ID,factory.county_id FROM boiler
    INNER JOIN exhaust
    ON exhaust.EXF_ID=boiler.EXHUST_ID
    INNER JOIN factory
    ON exhaust.FACTORY_ID=factory.factory_id
    ) ss
    ON county.COUNTY_ID=ss.county_id
    INNER JOIN city
    ON county.city_code=city.city_code
    GROUP BY county.COUNTY_ID
    ORDER BY county.city_code ASC
  </select>
  <update id="updateById" parameterType="nankai.xl.business.model.Boiler" >
    update boiler
    <set >
      <if test="tboilerId != null" >
        TBOILER_ID = #{tboilerId,jdbcType=INTEGER},
      </if>
      <if test="no != null" >
        NO = #{no,jdbcType=INTEGER},
      </if>
      <if test="version != null" >
        version = #{version,jdbcType=VARCHAR},
      </if>
      <if test="functionDec != null" >
        FUNCTION_DEC = #{functionDec,jdbcType=VARCHAR},
      </if>
      <if test="functio != null" >
        FUNCTIO = #{functio,jdbcType=CHAR},
      </if>
      <if test="fueltypeDec != null" >
        FUELTYPE_DEC = #{fueltypeDec,jdbcType=VARCHAR},
      </if>
      <if test="modelDec != null" >
        MODEL_DEC = #{modelDec,jdbcType=VARCHAR},
      </if>
      <if test="model != null" >
        MODEL = #{model,jdbcType=CHAR},
      </if>
      <if test="tons != null" >
        TONS = #{tons,jdbcType=DOUBLE},
      </if>
      <if test="fueltype != null" >
        FUELTYPE = #{fueltype,jdbcType=CHAR},
      </if>
      <if test="coalash != null" >
        COALASH = #{coalash,jdbcType=DOUBLE},
      </if>
      <if test="coalsulfur != null" >
        COALSULFUR = #{coalsulfur,jdbcType=DOUBLE},
      </if>
      <if test="combustionsystem != null" >
        COMBUSTIONSYSTEM = #{combustionsystem,jdbcType=CHAR},
      </if>
      <if test="fuelAusage != null" >
        FUEL_AUSAGE = #{fuelAusage,jdbcType=DOUBLE},
      </if>
      <if test="fuelAusageunit != null" >
        FUEL_AUSAGEUNIT = #{fuelAusageunit,jdbcType=CHAR},
      </if>
      <if test="exhustId != null" >
        EXHUST_ID = #{exhustId,jdbcType=INTEGER},
      </if>
      <if test="exfNo != null" >
        EXF_NO = #{exfNo,jdbcType=INTEGER},
      </if>
      <if test="nkNo != null" >
        NK_NO = #{nkNo,jdbcType=INTEGER},
      </if>
      <if test="dustremoveId != null" >
        dustremove_id = #{dustremoveId,jdbcType=INTEGER},
      </if>
      <if test="dustremoveDec != null" >
        dustremove_dec = #{dustremoveDec,jdbcType=VARCHAR},
      </if>
      <if test="nitreremoveDec != null" >
        nitreremove_dec = #{nitreremoveDec,jdbcType=VARCHAR},
      </if>
      <if test="sulphurremoveDec != null" >
        sulphurremove_dec = #{sulphurremoveDec,jdbcType=VARCHAR},
      </if>
      <if test="sulphurremoveId != null" >
        sulphurremove_id = #{sulphurremoveId,jdbcType=INTEGER},
      </if>
      <if test="nitreremoveId != null" >
        nitreremove_id = #{nitreremoveId,jdbcType=INTEGER},
      </if>
      <if test="factorStatus != null" >
        factor_status = #{factorStatus,jdbcType=TINYINT},
      </if>
      <if test="factorPm10 != null" >
        factor_pm10 = #{factorPm10,jdbcType=DOUBLE},
      </if>
      <if test="pm10 != null" >
        pm10 = #{pm10,jdbcType=DOUBLE},
      </if>
      <if test="factorPm25 != null" >
        factor_pm25 = #{factorPm25,jdbcType=DOUBLE},
      </if>
      <if test="pm25 != null" >
        pm25 = #{pm25,jdbcType=DOUBLE},
      </if>
      <if test="factorCo != null" >
        factor_co = #{factorCo,jdbcType=DOUBLE},
      </if>
      <if test="co != null" >
        co = #{co,jdbcType=DOUBLE},
      </if>
      <if test="factorVoc != null" >
        factor_voc = #{factorVoc,jdbcType=DOUBLE},
      </if>
      <if test="voc != null" >
        voc = #{voc,jdbcType=DOUBLE},
      </if>
      <if test="factorPm != null" >
        factor_pm = #{factorPm,jdbcType=DOUBLE},
      </if>
      <if test="pm != null" >
        pm = #{pm,jdbcType=DOUBLE},
      </if>
      <if test="factorSo2 != null" >
        factor_so2 = #{factorSo2,jdbcType=DOUBLE},
      </if>
      <if test="so2 != null" >
        so2 = #{so2,jdbcType=DOUBLE},
      </if>
      <if test="factorNox != null" >
        factor_nox = #{factorNox,jdbcType=DOUBLE},
      </if>
      <if test="nox != null" >
        nox = #{nox,jdbcType=DOUBLE},
      </if>
      <if test="factorNh3 != null" >
        factor_nh3 = #{factorNh3,jdbcType=DOUBLE},
      </if>
      <if test="nh3 != null" >
        nh3 = #{nh3,jdbcType=DOUBLE},
      </if>
      <if test="factorOc != null" >
        factor_oc = #{factorOc,jdbcType=DOUBLE},
      </if>
      <if test="oc != null" >
        oc = #{oc,jdbcType=DOUBLE},
      </if>
      <if test="factorBc != null" >
        factor_bc = #{factorBc,jdbcType=DOUBLE},
      </if>
      <if test="bc != null" >
        bc = #{bc,jdbcType=DOUBLE},
      </if>
      <if test="scc != null" >
        scc = #{scc,jdbcType=CHAR},
      </if>
      <if test="machineNo != null" >
        machine_no = #{machineNo,jdbcType=VARCHAR},
      </if>
      <if test="coalVolatilisation != null" >
        coal_volatilisation = #{coalVolatilisation,jdbcType=DOUBLE},
      </if>
      <if test="installedCapacity != null" >
        installed_capacity = #{installedCapacity,jdbcType=DOUBLE},
      </if>
      <if test="feiqiti != null" >
        feiqiti = #{feiqiti,jdbcType=DOUBLE},
      </if>
      <if test="so2out != null" >
        so2out = #{so2out,jdbcType=DOUBLE},
      </if>
      <if test="pmout != null" >
        pmout = #{pmout,jdbcType=DOUBLE},
      </if>
      <if test="noxout != null" >
        noxout = #{noxout,jdbcType=DOUBLE},
      </if>
      <if test="janUseamount != null" >
        Jan_useamount = #{janUseamount,jdbcType=DOUBLE},
      </if>
      <if test="febUseamount != null" >
        Feb_useamount = #{febUseamount,jdbcType=DOUBLE},
      </if>
      <if test="marUseamount != null" >
        Mar_useamount = #{marUseamount,jdbcType=DOUBLE},
      </if>
      <if test="aprUseamount != null" >
        Apr_useamount = #{aprUseamount,jdbcType=DOUBLE},
      </if>
      <if test="mayUseamount != null" >
        May_useamount = #{mayUseamount,jdbcType=DOUBLE},
      </if>
      <if test="juneUseamount != null" >
        June_useamount = #{juneUseamount,jdbcType=DOUBLE},
      </if>
      <if test="julyUseamount != null" >
        July_useamount = #{julyUseamount,jdbcType=DOUBLE},
      </if>
      <if test="augUseamount != null" >
        aug_useamount = #{augUseamount,jdbcType=DOUBLE},
      </if>
      <if test="septUseamount != null" >
        sept_useamount = #{septUseamount,jdbcType=DOUBLE},
      </if>
      <if test="octUseAmount != null" >
        oct_use_amount = #{octUseAmount,jdbcType=DOUBLE},
      </if>
      <if test="novUseamount != null" >
        nov_useamount = #{novUseamount,jdbcType=DOUBLE},
      </if>
      <if test="decUseamount != null" >
        dec_useamount = #{decUseamount,jdbcType=DOUBLE},
      </if>
    </set>
    where ID = #{id,jdbcType=INTEGER}
  </update>
  <insert id="insertOrUpdate" parameterType="nankai.xl.business.model.Boiler" >
    insert into boiler (ID, TBOILER_ID, NO,
      version, FUNCTION_DEC, FUNCTIO,
      FUELTYPE_DEC, MODEL_DEC, MODEL,
      TONS, FUELTYPE, COALASH,
      COALSULFUR, COMBUSTIONSYSTEM, FUEL_AUSAGE,
      FUEL_AUSAGEUNIT, EXHUST_ID, EXF_NO,
      NK_NO, dustremove_id, dustremove_dec,
      nitreremove_dec, sulphurremove_dec, sulphurremove_id,
      nitreremove_id, factor_status, factor_pm10,
      pm10, factor_pm25, pm25,
      factor_co, co, factor_voc,
      voc, factor_pm, pm, factor_so2,
      so2, factor_nox, nox, factor_nh3,
      nh3, factor_oc, oc, factor_bc,
      bc, scc, machine_no, coal_volatilisation,
      installed_capacity, feiqiti, so2out,
      pmout, noxout, Jan_useamount,
      Feb_useamount, Mar_useamount, Apr_useamount,
      May_useamount, June_useamount, July_useamount,
      aug_useamount, sept_useamount, oct_use_amount,
      nov_useamount, dec_useamount)
    values (#{id,jdbcType=INTEGER}, #{tboilerId,jdbcType=INTEGER}, #{no,jdbcType=INTEGER},
      #{version,jdbcType=VARCHAR}, #{functionDec,jdbcType=VARCHAR}, #{functio,jdbcType=CHAR},
      #{fueltypeDec,jdbcType=VARCHAR}, #{modelDec,jdbcType=VARCHAR}, #{model,jdbcType=CHAR},
      #{tons,jdbcType=DOUBLE}, #{fueltype,jdbcType=CHAR}, #{coalash,jdbcType=DOUBLE},
      #{coalsulfur,jdbcType=DOUBLE}, #{combustionsystem,jdbcType=CHAR}, #{fuelAusage,jdbcType=DOUBLE},
      #{fuelAusageunit,jdbcType=CHAR}, #{exhustId,jdbcType=INTEGER}, #{exfNo,jdbcType=INTEGER},
      #{nkNo,jdbcType=INTEGER}, #{dustremoveId,jdbcType=INTEGER}, #{dustremoveDec,jdbcType=VARCHAR},
      #{nitreremoveDec,jdbcType=VARCHAR}, #{sulphurremoveDec,jdbcType=VARCHAR}, #{sulphurremoveId,jdbcType=INTEGER},
      #{nitreremoveId,jdbcType=INTEGER}, #{factorStatus,jdbcType=TINYINT}, #{factorPm10,jdbcType=DOUBLE},
      #{pm10,jdbcType=DOUBLE}, #{factorPm25,jdbcType=DOUBLE}, #{pm25,jdbcType=DOUBLE},
      #{factorCo,jdbcType=DOUBLE}, #{co,jdbcType=DOUBLE}, #{factorVoc,jdbcType=DOUBLE},
      #{voc,jdbcType=DOUBLE}, #{factorPm,jdbcType=DOUBLE}, #{pm,jdbcType=DOUBLE}, #{factorSo2,jdbcType=DOUBLE},
      #{so2,jdbcType=DOUBLE}, #{factorNox,jdbcType=DOUBLE}, #{nox,jdbcType=DOUBLE}, #{factorNh3,jdbcType=DOUBLE},
      #{nh3,jdbcType=DOUBLE}, #{factorOc,jdbcType=DOUBLE}, #{oc,jdbcType=DOUBLE}, #{factorBc,jdbcType=DOUBLE},
      #{bc,jdbcType=DOUBLE}, #{scc,jdbcType=CHAR}, #{machineNo,jdbcType=VARCHAR}, #{coalVolatilisation,jdbcType=DOUBLE},
      #{installedCapacity,jdbcType=DOUBLE}, #{feiqiti,jdbcType=DOUBLE}, #{so2out,jdbcType=DOUBLE},
      #{pmout,jdbcType=DOUBLE}, #{noxout,jdbcType=DOUBLE}, #{janUseamount,jdbcType=DOUBLE},
      #{febUseamount,jdbcType=DOUBLE}, #{marUseamount,jdbcType=DOUBLE}, #{aprUseamount,jdbcType=DOUBLE},
      #{mayUseamount,jdbcType=DOUBLE}, #{juneUseamount,jdbcType=DOUBLE}, #{julyUseamount,jdbcType=DOUBLE},
      #{augUseamount,jdbcType=DOUBLE}, #{septUseamount,jdbcType=DOUBLE}, #{octUseAmount,jdbcType=DOUBLE},
      #{novUseamount,jdbcType=DOUBLE}, #{decUseamount,jdbcType=DOUBLE})
      ON DUPLICATE KEY UPDATE
      dustremove_id = #{dustremoveId,jdbcType=INTEGER},
      dustremove_dec = #{dustremoveDec,jdbcType=VARCHAR},
      nitreremove_dec = #{nitreremoveDec,jdbcType=VARCHAR},
      sulphurremove_dec = #{sulphurremoveDec,jdbcType=VARCHAR},
      sulphurremove_id = #{sulphurremoveId,jdbcType=INTEGER},
      nitreremove_id = #{nitreremoveId,jdbcType=INTEGER},
      factor_status = #{factorStatus,jdbcType=TINYINT},
      factor_pm10 = #{factorPm10,jdbcType=DOUBLE},
      pm10 = #{pm10,jdbcType=DOUBLE},
      factor_pm25 = #{factorPm25,jdbcType=DOUBLE},
      pm25 = #{pm25,jdbcType=DOUBLE},
      factor_co = #{factorCo,jdbcType=DOUBLE},
      co = #{co,jdbcType=DOUBLE},
      factor_voc = #{factorVoc,jdbcType=DOUBLE},
      voc = #{voc,jdbcType=DOUBLE},
      factor_pm = #{factorPm,jdbcType=DOUBLE},
      pm = #{pm,jdbcType=DOUBLE},
      factor_so2 = #{factorSo2,jdbcType=DOUBLE},
      so2 = #{so2,jdbcType=DOUBLE},
      factor_nox = #{factorNox,jdbcType=DOUBLE},
      nox = #{nox,jdbcType=DOUBLE},
      factor_nh3 = #{factorNh3,jdbcType=DOUBLE},
      nh3 = #{nh3,jdbcType=DOUBLE},
      factor_oc = #{factorOc,jdbcType=DOUBLE},
      oc = #{oc,jdbcType=DOUBLE},
      factor_bc = #{factorBc,jdbcType=DOUBLE},
      bc = #{bc,jdbcType=DOUBLE},
      scc = #{scc,jdbcType=CHAR},
      machine_no = #{machineNo,jdbcType=VARCHAR},
      coal_volatilisation = #{coalVolatilisation,jdbcType=DOUBLE},
      installed_capacity = #{installedCapacity,jdbcType=DOUBLE},
      feiqiti = #{feiqiti,jdbcType=DOUBLE},
      so2out = #{so2out,jdbcType=DOUBLE},
      pmout = #{pmout,jdbcType=DOUBLE},
      noxout = #{noxout,jdbcType=DOUBLE},
      Jan_useamount = #{janUseamount,jdbcType=DOUBLE},
      Feb_useamount = #{febUseamount,jdbcType=DOUBLE},
      Mar_useamount = #{marUseamount,jdbcType=DOUBLE},
      Apr_useamount = #{aprUseamount,jdbcType=DOUBLE},
      May_useamount = #{mayUseamount,jdbcType=DOUBLE},
      June_useamount = #{juneUseamount,jdbcType=DOUBLE},
      July_useamount = #{julyUseamount,jdbcType=DOUBLE},
      aug_useamount = #{augUseamount,jdbcType=DOUBLE},
      sept_useamount = #{septUseamount,jdbcType=DOUBLE},
      oct_use_amount = #{octUseAmount,jdbcType=DOUBLE},
      nov_useamount = #{novUseamount,jdbcType=DOUBLE},
      dec_useamount = #{decUseamount,jdbcType=DOUBLE}
  </insert>
</mapper>