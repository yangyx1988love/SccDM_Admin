<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="nankai.xl.business.mapper.DeviceMapper" >
  <resultMap id="BaseResultMap" type="nankai.xl.business.model.Device" >
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="nk_no" property="nkNo" jdbcType="INTEGER" />
    <result column="productrawtotal_id" property="productrawtotalId" jdbcType="INTEGER" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="device_no" property="deviceNo" jdbcType="VARCHAR" />
    <result column="device_flow" property="deviceFlow" jdbcType="VARCHAR" />
    <result column="design_power" property="designPower" jdbcType="DOUBLE" />
    <result column="practical_power" property="practicalPower" jdbcType="DOUBLE" />
    <result column="EXHUST_NO" property="exhustNo" jdbcType="INTEGER" />
    <result column="EXHUST_ID" property="exhustId" jdbcType="INTEGER" />
    <result column="yearrun_days" property="yearrunDays" jdbcType="INTEGER" />
    <result column="design_unit" property="designUnit" jdbcType="CHAR" />
  </resultMap>
  <select id="selectById" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    select * from device
    where id = #{id,jdbcType=INTEGER}
  </select>
  <select id="selectByExfId" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    select * from device
    where EXHUST_ID = #{exhustId,jdbcType=INTEGER}
  </select>
  <select id="selectByFactoryId" resultType="nankai.xl.business.model.vo.DeviceVo" parameterType="java.lang.Integer" >
     SELECT id,NK_NO FROM device WHERE EXHUST_ID IN(
          SELECT EXF_ID FROM exhaust WHERE FACTORY_ID = #{factoryId,jdbcType=INTEGER}
          )
     ORDER BY NK_NO ASC
  </select>
  <insert id="insertOrUpdate" parameterType="nankai.xl.business.model.Device" >
    insert into device (id, nk_no, productrawtotal_id,
      name, device_no, device_flow,
      design_power, practical_power, EXHUST_NO,
      EXHUST_ID, yearrun_days, design_unit
      )
    values (#{id,jdbcType=INTEGER}, #{nkNo,jdbcType=INTEGER}, #{productrawtotalId,jdbcType=INTEGER},
      #{name,jdbcType=VARCHAR}, #{deviceNo,jdbcType=VARCHAR}, #{deviceFlow,jdbcType=VARCHAR},
      #{designPower,jdbcType=DOUBLE}, #{practicalPower,jdbcType=DOUBLE}, #{exhustNo,jdbcType=INTEGER},
      #{exhustId,jdbcType=INTEGER}, #{yearrunDays,jdbcType=INTEGER}, #{designUnit,jdbcType=CHAR}
      )
    ON DUPLICATE KEY UPDATE
      id = #{id,jdbcType=INTEGER},
      nk_no = #{nkNo,jdbcType=INTEGER},
      productrawtotal_id = #{productrawtotalId,jdbcType=INTEGER},
      name = #{name,jdbcType=VARCHAR},
      device_no = #{deviceNo,jdbcType=VARCHAR},
      device_flow = #{deviceFlow,jdbcType=VARCHAR},
      design_power = #{designPower,jdbcType=DOUBLE},
      practical_power = #{practicalPower,jdbcType=DOUBLE},
      EXHUST_NO = #{exhustNo,jdbcType=INTEGER},
      EXHUST_ID = #{exhustId,jdbcType=INTEGER},
      yearrun_days = #{yearrunDays,jdbcType=INTEGER},
      design_unit = #{designUnit,jdbcType=CHAR}
  </insert>
  <update id="updateById" parameterType="nankai.xl.business.model.Device" >
    update device
    <set >
      <if test="nkNo != null" >
        nk_no = #{nkNo,jdbcType=INTEGER},
      </if>
      <if test="productrawtotalId != null" >
        productrawtotal_id = #{productrawtotalId,jdbcType=INTEGER},
      </if>
      <if test="name != null" >
        name = #{name,jdbcType=VARCHAR},
      </if>
      <if test="deviceNo != null" >
        device_no = #{deviceNo,jdbcType=VARCHAR},
      </if>
      <if test="deviceFlow != null" >
        device_flow = #{deviceFlow,jdbcType=VARCHAR},
      </if>
      <if test="designPower != null" >
        design_power = #{designPower,jdbcType=DOUBLE},
      </if>
      <if test="practicalPower != null" >
        practical_power = #{practicalPower,jdbcType=DOUBLE},
      </if>
      <if test="exhustNo != null" >
        EXHUST_NO = #{exhustNo,jdbcType=INTEGER},
      </if>
      <if test="exhustId != null" >
        EXHUST_ID = #{exhustId,jdbcType=INTEGER},
      </if>
      <if test="yearrunDays != null" >
        yearrun_days = #{yearrunDays,jdbcType=INTEGER},
      </if>
      <if test="designUnit != null" >
        design_unit = #{designUnit,jdbcType=CHAR},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
</mapper>